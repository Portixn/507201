Option Explicit
Option Base 1

Sub match_vendor_number()
' %%%
' Portixn 2020/06/29
' Ready to use, not completed
' The Excel should consist of 3 tags: operation_panal grant vendor_name
' Copy the grant summary to new tab and rename the tab to grant
' %%%

Dim targetCol As Integer
Dim numberRows As Integer

'Columns("B:B").Select 'Find the vendors name
targetCol = Worksheets("grant").Range("A:Z").Find("Grant Recipient", lookat:=xlWhole).Column
Debug.Print "target_cell's_column is_" & targetCol

'worksheet cannot be selected. Need activate here.
Worksheets("grant").Activate
Columns(targetCol).Select
'insert column
Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove

'Range("B1").Select 'Name the column
Cells(1, targetCol).Select
ActiveCell.FormulaR1C1 = "vendor_number" 'R1C1: set the original point
'Range("B2").Select
Cells(2, targetCol).Select
'vlookup
'RC[1],the right 1 column
ActiveCell.FormulaR1C1 = "=VLOOKUP(RC[1],vendor_number!C1:C2,2,FALSE)"
ActiveWindow.DisplayFormulas = False

'get the total rows
numberRows = Worksheets("grant").UsedRange.Rows.Count
'fill the column
Selection.AutoFill Destination:=Range(Worksheets("grant").Cells(2, targetCol), Worksheets("grant").Cells(numberRows, targetCol))

MsgBox "In total " & numberRows - 1 & " vendor numbers are generated.", vbOKOnly

End Sub
